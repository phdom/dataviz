<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RIPM Dashboard · Two‑Way Relationship (Prototype v7 – fixed)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Add Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    #header-placeholder {
      min-height: 60px; /* Reserve space for header */
    }
  </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans">
  <!-- ===== Header Placeholder ===== -->
  <div id="header-placeholder"></div>

  <div class="lg:flex">
    <!-- ===== Sidebar ===== -->
    <aside class="hidden lg:block w-56 border-r bg-white min-h-screen p-4">
      <nav class="space-y-3 text-sm">
        <!-- Dashboard Link -->
        <div>
          <a href="index.html" class="block px-3 py-2 rounded hover:bg-slate-100">Dashboard Overview</a>
        </div>
      
        <!-- Strategic Result 1 -->
        <div>
          <h3 class="px-3 text-xs text-slate-500 uppercase tracking-wider font-semibold mb-1">Engaged & Loyal</h3>
          <a href="two_way_relationship.html" class="block pl-6 pr-3 py-2 rounded bg-indigo-50 text-indigo-700 font-medium">Two-Way Relationship</a>
          <a href="unknown_ambassadors.html" class="block pl-6 pr-3 py-2 rounded hover:bg-slate-100">Unknown Ambassadors</a>
        </div>
      
        <!-- Strategic Result 2 -->
        <div>
          <h3 class="px-3 text-xs text-slate-500 uppercase tracking-wider font-semibold mb-1">Community Presence</h3>
          <a href="community_interest.html" class="block pl-6 pr-3 py-2 rounded hover:bg-slate-100">Community Interest</a>
          <a href="news_content_output.html" class="block pl-6 pr-3 py-2 rounded hover:bg-slate-100">News Content Output</a>
          <a href="sponsors_value.html" class="block pl-6 pr-3 py-2 rounded hover:bg-slate-100">Sponsor Value</a>
        </div>
      
        <!-- Strategic Result 3 -->
         <div>
          <h3 class="px-3 text-xs text-slate-500 uppercase tracking-wider font-semibold mb-1">Financial Resilience</h3>
          <a href="membership_model.html" class="block pl-6 pr-3 py-2 rounded hover:bg-slate-100">Membership Model</a>
          <a href="local_revenue.html" class="block pl-6 pr-3 py-2 rounded hover:bg-slate-100">Local Revenue</a>
          <a href="gross_margin.html" class="block pl-6 pr-3 py-2 rounded hover:bg-slate-100">Gross Margin Rate</a>
        </div>
      
        <!-- Strategic Result 4 -->
         <div>
          <h3 class="px-3 text-xs text-slate-500 uppercase tracking-wider font-semibold mb-1">Unified Organization</h3>
          <a href="org_flow.html" class="block pl-6 pr-3 py-2 rounded hover:bg-slate-100">Org Flow & Agility</a>
        </div>
      </nav>
    </aside>

    <!-- ===== Main ===== -->
    <main class="flex-1 p-6 space-y-10">
      <!-- ==== Definition card ==== -->
      <section class="bg-white shadow rounded-xl p-6 border-l-4 border-indigo-500 relative">
        <h2 class="text-xl font-semibold">Measure One: Two‑Way Relationship</h2>
        <span class="absolute top-6 right-6 group cursor-help" aria-label="Metric rules apply to the fiscal year.">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-slate-400 group-hover:text-indigo-600 transition" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 4.418-3.582 8-8 8s-8-3.582-8-8 3.582-8 8-8 8 3.582 8 8zm-8-4a1 1 0 110-2 1 1 0 010 2zm1 11V9H9v8h2z" clip-rule="evenodd"/></svg>
        </span>
        <p class="text-sm leading-relaxed mt-2">Tracks the <strong>number of unique audience members</strong> who demonstrate an active relationship with RIPM by <em>attending at least one event, donating at least once, or subscribing & clicking through a newsletter within a fiscal year.</em> Each individual is counted once, regardless of how many actions they take.</p>
      </section>

      <!-- ==== Aggregate KPI and Trend Chart Section ==== -->
      <section class="grid md:grid-cols-3 gap-8 mb-10"> 
        <!-- Aggregate KPI Card (Column 1) -->
        <div class="md:col-span-1 bg-white shadow rounded-2xl p-4 flex flex-col gap-2">
          <h3 class="font-medium text-lg text-center text-indigo-700">Total Unique Two-Way Relationships</h3>
          <div class="flex items-center justify-center gap-x-6">
            <span class="text-6xl font-bold tracking-tight text-slate-800">7,800</span>
            <svg viewBox="0 0 36 36" class="w-20 h-20"><circle cx="18" cy="18" r="15.915" fill="none" stroke="#e2e8f0" stroke-width="4"/><circle cx="18" cy="18" r="15.915" fill="none" stroke="#4f46e5" stroke-width="4" stroke-dasharray="78 100" stroke-dashoffset="25" stroke-linecap="round"/><text x="18" y="21" fill="#4338ca" font-size="9" text-anchor="middle" font-weight="600">78%</text></svg>
          </div>
          <p class="text-sm text-slate-500 text-center">Target 10,000 (FY26) · Data through [Month]</p>
        </div>

        <!-- Trend Chart (Columns 2-3) -->
        <div class="md:col-span-2 bg-white shadow rounded-xl py-4 px-6 md:px-8">
          <h3 class="font-medium text-sm mb-2">Total Two‑Way Relationships vs FY26 Target</h3>
          <svg viewBox="-40 100 840 145" class="w-full h-auto text-indigo-500">
            <!-- Y Axis labels -->
            <text x="-10" y="220" dy="4" text-anchor="end" font-size="10" fill="#64748b">0</text>
            <text x="-10" y="200" dy="4" text-anchor="end" font-size="10" fill="#64748b">2.5k</text>
            <text x="-10" y="180" dy="4" text-anchor="end" font-size="10" fill="#64748b">5k</text>
            <text x="-10" y="160" dy="4" text-anchor="end" font-size="10" fill="#64748b">7.5k</text>
            <text x="-10" y="140" dy="4" text-anchor="end" font-size="10" fill="#64748b">10k</text>

            <!-- baseline -->
            <polyline fill="none" stroke="#e2e8f0" stroke-width="1" points="0,220 800,220" />
            <!-- quarter gridlines -->
            <polyline fill="none" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="2 6" points="200,100 200,220" />
            <polyline fill="none" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="2 6" points="400,100 400,220" />
            <polyline fill="none" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="2 6" points="600,100 600,220" />
            <!-- target dotted line -->
            <polyline fill="none" stroke="#a5b4fc" stroke-width="1.5" stroke-dasharray="4 4" points="0,140 800,140" />
            <!-- actual trend -->
            <polyline fill="none" stroke="currentColor" stroke-width="2.5" points="0,200 100,190 200,180 300,160 400,150 500,140 600,130 700,120 800,110" />
          
            <!-- X Axis labels -->
            <text x="0"   y="235" text-anchor="middle" font-size="10" fill="#64748b">Start FY26</text>
            <text x="200" y="235" text-anchor="middle" font-size="10" fill="#64748b">End Q1</text>
            <text x="400" y="235" text-anchor="middle" font-size="10" fill="#64748b">End Q2</text>
            <text x="600" y="235" text-anchor="middle" font-size="10" fill="#64748b">End Q3</text>
            <text x="800" y="235" text-anchor="middle" font-size="10" fill="#64748b">End Q4</text>
          </svg>
          <p class="text-xs text-slate-500 mt-1">FY26 Target: 10,000 unique relationships</p>
        </div>
      </section>

      <!-- ==== Component KPI cards ==== -->
      <section class="grid gap-8 md:grid-cols-3">
        <!-- Event Attendees -->
        <article class="bg-white shadow rounded-2xl p-6 flex flex-col gap-4 min-h-52">
          <h3 class="font-medium text-sm">Event Attendees</h3>
          <div class="flex items-center justify-between gap-x-3">
            <span class="text-4xl font-bold tracking-tight">2,345</span>
            <svg viewBox="0 0 36 36" class="w-16 h-16"><circle cx="18" cy="18" r="15.915" fill="none" stroke="#e2e8f0" stroke-width="5"/><circle cx="18" cy="18" r="15.915" fill="none" stroke="#4f46e5" stroke-width="5" stroke-dasharray="78 100" stroke-dashoffset="25" stroke-linecap="round"/><text x="18" y="20.5" fill="#4338ca" font-size="8" text-anchor="middle" font-weight="600">78%</text></svg>
          </div>
          <svg viewBox="0 0 160 24" class="w-full h-10 text-indigo-500"><polyline fill="none" stroke="currentColor" stroke-width="3" points="0,20 40,18 80,16 120,14 160,12"/></svg>
          <p class="text-xs text-slate-500">Target 3,000 · Data through [Month]</p>
        </article>

        <!-- Annual Donors -->
        <article class="bg-white shadow rounded-2xl p-6 flex flex-col gap-4 min-h-52">
          <h3 class="font-medium text-sm">Annual Donors</h3>
          <div class="flex items-center justify-between gap-x-3">
            <span class="text-4xl font-bold tracking-tight">1,120</span>
            <svg viewBox="0 0 36 36" class="w-16 h-16"><circle cx="18" cy="18" r="15.915" fill="none" stroke="#e2e8f0" stroke-width="5"/><circle cx="18" cy="18" r="15.915" fill="none" stroke="#4f46e5" stroke-width="5" stroke-dasharray="45 100" stroke-dashoffset="25" stroke-linecap="round"/><text x="18" y="20.5" fill="#4338ca" font-size="8" text-anchor="middle" font-weight="600">45%</text></svg>
          </div>
          <svg viewBox="0 0 160 24" class="w-full h-10 text-indigo-500"><polyline fill="none" stroke="currentColor" stroke-width="3" points="0,20 40,21 80,20 120,19 160,18"/></svg>
          <p class="text-xs text-slate-500">Target 2,500 · Data through [Month]</p>
        </article>

        <!-- Engaged Newsletter Subscribers -->
        <article class="bg-white shadow rounded-2xl p-6 flex flex-col gap-4 min-h-52">
          <h3 class="font-medium text-sm">Engaged Newsletter Subscribers</h3>
          <div class="flex items-center justify-between gap-x-3">
            <span class="text-4xl font-bold tracking-tight">4,560</span>
            <svg viewBox="0 0 36 36" class="w-16 h-16"><circle cx="18" cy="18" r="15.915" fill="none" stroke="#e2e8f0" stroke-width="5"/><circle cx="18" cy="18" r="15.915" fill="none" stroke="#4f46e5" stroke-width="5" stroke-dasharray="76 100" stroke-dashoffset="25" stroke-linecap="round"/><text x="18" y="20.5" fill="#4338ca" font-size="8" text-anchor="middle" font-weight="600">76%</text></svg>
          </div>
          <svg viewBox="0 0 160 24" class="w-full h-10 text-indigo-500"><polyline fill="none" stroke="currentColor" stroke-width="3" points="0,20 40,15 80,12 120,10 160,8"/></svg>
          <p class="text-xs text-slate-500">Target 6,000 · Data through [Month]</p>
        </article>
      </section>

      <!-- ==== Data table ==== -->
      <section class="bg-white shadow rounded-xl p-6 overflow-x-auto">
        <h3 class="text-base font-medium mb-4">Data & Measurement Details</h3>
        <table class="min-w-max text-sm border-collapse">
          <thead class="bg-slate-100 text-left whitespace-nowrap">
            <tr>
              <th class="px-4 py-2 font-semibold">Metric</th>
              <th class="px-4 py-2 font-semibold">Definition</th>
              <th class="px-4 py-2 font-semibold">Data Source</th>
              <th class="px-4 py-2 font-semibold">Ingestion Method</th>
              <th class="px-4 py-2 font-semibold">Reporting Frequency</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-slate-100">
            <tr>
              <td class="px-4 py-3 sticky left-0 bg-white font-medium">Event Attendees</td>
              <td class="px-4 py-3">At least one event attended</td>
              <td class="px-4 py-3">Google Forms · Eventbrite · OneCause</td>
              <td class="px-4 py-3">Manual → Google Sheets</td>
              <td class="px-4 py-3">Monthly</td>
            </tr>
            <tr>
              <td class="px-4 py-3 sticky left-0 bg-white font-medium">Annual Donors</td>
              <td class="px-4 py-3">At least one donation</td>
              <td class="px-4 py-3">CDP · MSB</td>
              <td class="px-4 py-3">Manual → Google Sheets</td>
              <td class="px-4 py-3">Monthly</td>
            </tr>
            <tr>
              <td class="px-4 py-3 sticky left-0 bg-white font-medium">Engaged Newsletter Subs</td>
              <td class="px-4 py-3">Subscribed & ≥1 click</td>
              <td class="px-4 py-3">Constant Contact · GetResponse</td>
              <td class="px-4 py-3">API</td>
              <td class="px-4 py-3">Monthly</td>
            </tr>
          </tbody>
        </table>
      </section>
    </main>
  </div>

  <script>
    // Function to load the header
    function loadHeader() {
      fetch('_header.html')
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok ' + response.statusText);
          }
          return response.text();
        })
        .then(data => {
          document.getElementById('header-placeholder').innerHTML = data;
          updateHeaderTitle(); // Call the function to update the title
        })
        .catch(error => {
          console.error('Error loading the header:', error);
          document.getElementById('header-placeholder').innerHTML = '<p class="text-red-500 text-center p-4">Error loading header content.</p>';
        });
    }

    // Function to update the header title based on the active sidebar link
    function updateHeaderTitle() {
      try {
        const activeLink = document.querySelector('aside nav a.bg-indigo-50');
        if (!activeLink) return; // No active link found

        // Find the closest parent div containing the link
        const parentDiv = activeLink.closest('div');
        if (!parentDiv) return;

        // Find the preceding h3 sibling within the same parent container
        const strategicResultHeading = parentDiv.querySelector('h3.px-3');
        // If h3 isn't in the same div, look for the previous sibling that contains an h3
        let currentElement = parentDiv;
        let headingElement = strategicResultHeading;
        while (!headingElement && currentElement.previousElementSibling) {
            currentElement = currentElement.previousElementSibling;
            headingElement = currentElement.querySelector('h3.px-3');
        }

        if (headingElement && headingElement.textContent) {
          const headerTitleSpan = document.getElementById('strategic-result-name');
          if (headerTitleSpan) {
            // Use textContent and trim whitespace
            headerTitleSpan.textContent = headingElement.textContent.trim();
          }
        }
      } catch (error) {
        console.error('Error updating header title:', error);
      }
    }

    // Load the header when the page finishes loading
    document.addEventListener('DOMContentLoaded', loadHeader);
  </script>
</body>
</html> 